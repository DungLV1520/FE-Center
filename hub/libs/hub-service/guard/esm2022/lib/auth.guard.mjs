import { inject } from '@angular/core';
import { Router } from '@angular/router';
import { LocalStorageService, LocalStoreEnum, } from '@hub-center/hub-service/storage';
export const authGuard = (route, state) => {
    const router = inject(Router);
    const localStorageService = inject(LocalStorageService);
    const accessToken = localStorageService.getItem(LocalStoreEnum.ACCESS_TOKEN);
    const currentUser = JSON.parse(localStorageService.getItem(LocalStoreEnum.CUSTOMER_KEY));
    // const roleAdmin = [Role.ROLE_ADMIN, Role.ROLE_USER];
    // const isAdmin = currentUser?.roles?.every((role: string) =>
    //   roleAdmin.includes(role as Role)
    // );
    // if (currentUser && isAdmin) {
    //   return true;
    // }
    if (currentUser && accessToken) {
        return true;
    }
    localStorageService.removeItem(LocalStoreEnum.ACCESS_TOKEN);
    localStorageService.removeItem(LocalStoreEnum.CUSTOMER_KEY);
    router.navigate(['/login'], {
        queryParams: { returnUrl: state.url },
    });
    return false;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aC5ndWFyZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvaHViLXNlcnZpY2UvZ3VhcmQvc3JjL2xpYi9hdXRoLmd1YXJkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkMsT0FBTyxFQUFpQixNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUV4RCxPQUFPLEVBQ0wsbUJBQW1CLEVBQ25CLGNBQWMsR0FDZixNQUFNLGlDQUFpQyxDQUFDO0FBRXpDLE1BQU0sQ0FBQyxNQUFNLFNBQVMsR0FBa0IsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUU7SUFDdkQsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzlCLE1BQU0sbUJBQW1CLEdBQUcsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUM7SUFDeEQsTUFBTSxXQUFXLEdBQUcsbUJBQW1CLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUM3RSxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUM1QixtQkFBbUIsQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxDQUN6RCxDQUFDO0lBQ0YsdURBQXVEO0lBRXZELDhEQUE4RDtJQUM5RCxxQ0FBcUM7SUFDckMsS0FBSztJQUVMLGdDQUFnQztJQUNoQyxpQkFBaUI7SUFDakIsSUFBSTtJQUVKLElBQUksV0FBVyxJQUFJLFdBQVcsRUFBRTtRQUM5QixPQUFPLElBQUksQ0FBQztLQUNiO0lBRUQsbUJBQW1CLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUM1RCxtQkFBbUIsQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzVELE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBRTtRQUMxQixXQUFXLEVBQUUsRUFBRSxTQUFTLEVBQUUsS0FBSyxDQUFDLEdBQUcsRUFBRTtLQUN0QyxDQUFDLENBQUM7SUFFSCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluamVjdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ2FuQWN0aXZhdGVGbiwgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IFJvbGUgfSBmcm9tICdAaHViLWNlbnRlci9odWItbW9kZWwnO1xuaW1wb3J0IHtcbiAgTG9jYWxTdG9yYWdlU2VydmljZSxcbiAgTG9jYWxTdG9yZUVudW0sXG59IGZyb20gJ0BodWItY2VudGVyL2h1Yi1zZXJ2aWNlL3N0b3JhZ2UnO1xuXG5leHBvcnQgY29uc3QgYXV0aEd1YXJkOiBDYW5BY3RpdmF0ZUZuID0gKHJvdXRlLCBzdGF0ZSkgPT4ge1xuICBjb25zdCByb3V0ZXIgPSBpbmplY3QoUm91dGVyKTtcbiAgY29uc3QgbG9jYWxTdG9yYWdlU2VydmljZSA9IGluamVjdChMb2NhbFN0b3JhZ2VTZXJ2aWNlKTtcbiAgY29uc3QgYWNjZXNzVG9rZW4gPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldEl0ZW0oTG9jYWxTdG9yZUVudW0uQUNDRVNTX1RPS0VOKTtcbiAgY29uc3QgY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKFxuICAgIGxvY2FsU3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShMb2NhbFN0b3JlRW51bS5DVVNUT01FUl9LRVkpXG4gICk7XG4gIC8vIGNvbnN0IHJvbGVBZG1pbiA9IFtSb2xlLlJPTEVfQURNSU4sIFJvbGUuUk9MRV9VU0VSXTtcblxuICAvLyBjb25zdCBpc0FkbWluID0gY3VycmVudFVzZXI/LnJvbGVzPy5ldmVyeSgocm9sZTogc3RyaW5nKSA9PlxuICAvLyAgIHJvbGVBZG1pbi5pbmNsdWRlcyhyb2xlIGFzIFJvbGUpXG4gIC8vICk7XG5cbiAgLy8gaWYgKGN1cnJlbnRVc2VyICYmIGlzQWRtaW4pIHtcbiAgLy8gICByZXR1cm4gdHJ1ZTtcbiAgLy8gfVxuXG4gIGlmIChjdXJyZW50VXNlciAmJiBhY2Nlc3NUb2tlbikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgbG9jYWxTdG9yYWdlU2VydmljZS5yZW1vdmVJdGVtKExvY2FsU3RvcmVFbnVtLkFDQ0VTU19UT0tFTik7XG4gIGxvY2FsU3RvcmFnZVNlcnZpY2UucmVtb3ZlSXRlbShMb2NhbFN0b3JlRW51bS5DVVNUT01FUl9LRVkpO1xuICByb3V0ZXIubmF2aWdhdGUoWycvbG9naW4nXSwge1xuICAgIHF1ZXJ5UGFyYW1zOiB7IHJldHVyblVybDogc3RhdGUudXJsIH0sXG4gIH0pO1xuXG4gIHJldHVybiBmYWxzZTtcbn07XG4iXX0=